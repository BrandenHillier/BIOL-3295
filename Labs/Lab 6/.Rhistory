source('~/Desktop/BIOL-3295/Labs/Lab 6/Evolutionary_Simulation.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
getwd()
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
list.files('Maturation_Strategies', pattern=NULL, all.files=FALSE,
full.names=FALSE)
strategies.list = list.files('Maturation_Strategies', pattern=NULL, all.files=FALSE,
full.names=FALSE)
strategies.list = list.files('Maturation_Strategies')
strategies.list
length(strategies.list)
strategies.list[1]
source('Maturation_Strategies/strategies.list[1]')
source('Maturation_Strategies/unname(strategies.list[1])')
unname(strategies.list[1])
source(strategies.list[1])
getwd()
setwd("/Users/amyhurford/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Strategies")
source(strategies.list[1])
setwd("Maturation_Strategies")
setwd("/Users/amyhurford/Desktop/BIOL-3295/Labs/Lab 6/")
dir(strategies.list[1], pattern=NULL, all.files=FALSE,
full.names=FALSE)
dir("AmyStrategy1.R", pattern=NULL, all.files=FALSE,
full.names=FALSE)
list.files
list.files(getwd())
# Remove all objects - usually start with this
rm(list=ls())
# Load in strategies from the "Maturation_Strategies" folder
strategies.list = list.files('Maturation_Strategies')
Strategy = NULL
setwd("~/Maturation_Strategies")
# Remove all objects - usually start with this
rm(list=ls())
# Load in strategies from the "Maturation_Strategies" folder
strategies.list = list.files('Maturation_Strategies')
Strategy = NULL
source('strategies.list[1]')
wd = getwd()
wd
strategies.list[1]
unname(strategies.list[1])
list.dirs("Maturation_Strategies")
list.dirs("Maturation_Strategies")
setwd(list.dirs("Maturation_Strategies"))
getwd()
source('strategies.list[1]')
setwd(list.dirs("Maturation_Strategies/"))
setwd(list.dirs("Maturation_Strategies"))
# Remove all objects - usually start with this
rm(list=ls())
# Load in strategies from the "Maturation_Strategies" folder
strategies.list = list.files('Maturation_Strategies')
setwd(list.dirs("Maturation_Strategies"))
Strategy = NULL
getwd()
source('strategies.list[1]')
# Remove all objects - usually start with this
rm(list=ls())
# Load in strategies from the "Maturation_Strategies" folder
strategies.list = list.files('Maturation_Strategies')
setwd(list.dirs("Maturation_Strategies/"))
Strategy = NULL
source('strategies.list[1]')
setwd(list.dirs("Maturation_Strategies/AmyStrategy2.R"))
# Remove all objects - usually start with this
rm(list=ls())
# Load in strategies from the "Maturation_Strategies" folder
strategies.list = list.files('Maturation_Strategies')
setwd("Maturation_Strategies"))
Strategy = NULL
source('strategies.list[1]')
getwd()
# Remove all objects - usually start with this
rm(list=ls())
# Load in strategies from the "Maturation_Strategies" folder
strategies.list = list.files('Maturation_Strategies')
setwd("Maturation_Strategies/"))
Strategy = NULL
source('strategies.list[1]')
strategies.list
getwd
getwd()
# Remove all objects - usually start with this
rm(list=ls())
# Load in strategies from the "Maturation_Strategies" folder
strategies.list = list.files('Maturation_Strategies')
setwd("Maturation_Strategies"))
Strategy = NULL
source('strategies.list[1]')
strategies.list
strategies.list = list.files('Maturation_Strategies')
strategies.list
getwd()
dir = list.dirs(".")
dir
dir = list.dirs("Maturation_Evolution.R")
dir
setwd(getSrcDirectory()[1])
setwd(getSrcDirectory("Maturation_Evolution.R")[1])
setwd(getSrcDirectory()["Maturation_Evolution.R"])
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Remove all objects - usually start with this
rm(list=ls())
this.dir <- dirname(parent.frame(2)$ofile)
setwd(this.dir)
this.dir <- dirname(parent.frame(2)$ofile)
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
this.dir
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
wd
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
wd
wd = getwd()
wd
# Remove all objects - usually start with this
rm(list=ls())
wd = getwd()
# Load in strategies from the "Maturation_Strategies" folder
strategies.list = list.files('Maturation_Strategies')
setwd("Maturation_Strategies")
Strategy = NULL
source('strategies.list[1]')
rm(list=ls())
wd = getwd()
# Load in strategies from the "Maturation_Strategies" folder
strategies.list = list.files('Maturation_Strategies')
setwd("Maturation_Strategies")
strategies.list
rm(list=ls())
wd = getwd()
wd
strategies.list = list.files('Maturation_Strategies')
strategies.list
wd = getwd()
wd
wd = getwd("/Users/amyhurford/Desktop/BIOL-3295/Labs/Lab 6/")
# Remove all objects - usually start with this
rm(list=ls())
wd = "/Users/amyhurford/Desktop/BIOL-3295/Labs/Lab 6/"
wd
# Remove all objects - usually start with this
rm(list=ls())
wd = "/Users/amyhurford/Desktop/BIOL-3295/Labs/Lab 6/"
# Load in strategies from the "Maturation_Strategies" folder
strategies.list = list.files('Maturation_Strategies')
setwd("Maturation_Strategies")
Strategy = NULL
source('strategies.list[1]')
strategies.list
# Remove all objects - usually start with this
rm(list=ls())
wd = "/Users/amyhurford/Desktop/BIOL-3295/Labs/Lab 6/"
setwd(wd)
# Load in strategies from the "Maturation_Strategies" folder
strategies.list = list.files('Maturation_Strategies')
setwd("Maturation_Strategies")
Strategy = NULL
strategies.list
# Remove all objects - usually start with this
rm(list=ls())
wd = "/Users/amyhurford/Desktop/BIOL-3295/Labs/Lab 6/"
setwd(wd)
# Load in strategies from the "Maturation_Strategies" folder
strategies.list = list.files('Maturation_Strategies')
setwd("Maturation_Strategies")
Strategy = NULL
for(i in length(strategies.list)){
source('strategies.list[1]')
Strategy = rbind(Strategy,c(Name=i, b=b, d=d))
}
# Remove all objects - usually start with this
rm(list=ls())
wd = "/Users/amyhurford/Desktop/BIOL-3295/Labs/Lab 6/"
setwd(wd)
# Load in strategies from the "Maturation_Strategies" folder
strategies.list = list.files('Maturation_Strategies')
setwd("Maturation_Strategies")
Strategy = NULL
for(i in length(strategies.list)){
source('strategies.list[i]')
Strategy = rbind(Strategy,c(Name=i, b=b, d=d))
}
startegies.list
stategies.list
strategies.list
# Remove all objects - usually start with this
rm(list=ls())
wd = "/Users/amyhurford/Desktop/BIOL-3295/Labs/Lab 6/"
setwd(wd)
# Load in strategies from the "Maturation_Strategies" folder
strategies.list = list.files('Maturation_Strategies')
setwd("Maturation_Strategies")
Strategy = NULL
for(i in seq(1,length(strategies.list))){
source('strategies.list[i]')
Strategy = rbind(Strategy,c(Name=i, b=b, d=d))
}
seq(1,length(strategies.list)
)
# Remove all objects - usually start with this
rm(list=ls())
wd = "/Users/amyhurford/Desktop/BIOL-3295/Labs/Lab 6/"
setwd(wd)
# Load in strategies from the "Maturation_Strategies" folder
strategies.list = list.files('Maturation_Strategies')
setwd("Maturation_Strategies")
Strategy = NULL
for(i in seq(1,length(strategies.list))){
source('strategies.list[1]')
Strategy = rbind(Strategy,c(Name=i, b=b, d=d))
}
strategies.list
strategies.list[1]
source(strategies.list[1])
# Remove all objects - usually start with this
rm(list=ls())
wd = "/Users/amyhurford/Desktop/BIOL-3295/Labs/Lab 6/"
setwd(wd)
# Load in strategies from the "Maturation_Strategies" folder
strategies.list = list.files('Maturation_Strategies')
setwd("Maturation_Strategies")
Strategy = NULL
for(i in seq(1,length(strategies.list))){
source(strategies.list[1])
Strategy = rbind(Strategy,c(Name=i, b=b, d=d))
}
Strategy
# Remove all objects - usually start with this
rm(list=ls())
wd = "/Users/amyhurford/Desktop/BIOL-3295/Labs/Lab 6/"
setwd(wd)
# Load in strategies from the "Maturation_Strategies" folder
strategies.list = list.files('Maturation_Strategies')
setwd("Maturation_Strategies")
Strategy = NULL
for(i in seq(1,length(strategies.list))){
source(strategies.list[i])
Strategy = rbind(Strategy,c(Name=i, b=b, d=d))
}
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
Number = matrix(0,total.time,Number.Strategies)
Number[1,1:2] = 1000/Number.Strategies
Number = matrix(0,total.time,Number.Strategies)
Number
Number[1,1:2] = 1000/Number.Strategies
Number
# EVOLUTIONARY SIMULATION: time of maturation
# Remove all objects - usually start with this
rm(list=ls())
# Record the directory of this file. It is hard to automate
# this step: you will need to write it in.
wd = "/Users/amyhurford/Desktop/BIOL-3295/Labs/Lab 6/"
# Set the working directory to the directory of the current file
setwd(wd)
# Create a list of all the strategies in the "Maturation_Strategies" folder
strategies.list = list.files('Maturation_Strategies')
# The number of strategies
Number.Strategies = length(strategies.list)
# set the working directory to the subfolder: "Maturation_Strategies", note
# that all the strategies you want to load in should be in a subfolder
# located in the same directory as this file.
setwd("Maturation_Strategies")
# Strategy is a dataframe listing all the strategies. The line below
# is preallocation
Strategy = NULL
# Each strategy is named by its position in strategies.list.
for(i in seq(1,Number.Strategies)){
source(strategies.list[i])
Strategy = rbind(Strategy,c(Name=i, b=b, d=d))
}
# Strategy is converted into a dataframe.
Strategy = as.data.frame(Strategy)
# The number of time steps to run the simulation
total.time = 200
# The initial number of individuals with each strategy
# Preallocation
Number = matrix(0,total.time,Number.Strategies)
# Begin with equal abundance of each strategy
Number[1,1:Number.Strategies] = 1000/Number.Strategies
require(viridis)
viridis(10)
Colours = viridis(Number.Strategies)
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Maturation_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
tail(Popn)
c(unname(t),t(unname(table(Popn$strategy))))
Number
head(Number)
ind.b
Popn$strategy[ind.b]
table(Popn$strategy)
tail(Popn$strategy)
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
tail(Popn$strategy)
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
# EVOLUTIONARY SIMULATION: Evolution of body size in Drosphila
# Based on the section beginning on p107 of Fox et al.
# Remove all objects - usually start with this
rm(list=ls())
# Load a package that provides a color palette
require(viridis)
# The number of time steps to run the simulation
total.time = 500
# Larval mortality rate
l0 = 1
# Adult mortality rate
l1 = 1
Popn.Size=10
# Record the directory of this file. It is hard to automate
# this step: you will need to write it in.
wd = "/Users/amyhurford/Desktop/BIOL-3295/Labs/Lab 6/"
# Set the working directory to the directory of the current file
setwd(wd)
# Create a list of all the strategies in the "Body_Size_Strategies" folder
strategies.list = list.files('Body_Size_Strategies')
# The number of strategies
Number.Strategies = length(strategies.list)
# set the working directory to the subfolder: "Body_Size_Strategies", note
# that all the strategies you want to load in should be in a subfolder
# located in the same directory as this file.
setwd("Body_Size_Strategies")
source(strategies.list[1])
Strategy = data.frame(Strategy=1,L=L)
# Each strategy is named by its position in strategies.list.
for(i in seq(2,Number.Strategies)){
source(strategies.list[i])
Strategy = rbind(Strategy,c(Strategy = i,L=L))
}
# Change back the working directory
setwd(wd)
# The development function
Development = function(L){
d0 =1
d1 = 1
d2 = 1
D = d0*L^d1 + d2
return(D)
}
Develop.time = Development(Strategy$L)
Strategy = cbind(Strategy,Develop.time)
# Define the characteristics of all indviduals in the population
strategy = NULL
develop.time = NULL
L = NULL
age = NULL
for(i in seq(1,Number.Strategies)){
strategy = c(strategy,rep(i,Popn.Size/Number.Strategies))
develop.time=c(develop.time,rep(Strategy$Develop.time[i],Popn.Size/Number.Strategies))
L = c(L,rep(Strategy$Develop.time[i],Popn.Size/Number.Strategies))
age=c(age,rep(0,Popn.Size/Number.Strategies))
}
Popn = data.frame(cbind(strategy=strategy,age=age,L=L,develop.time))
Popn
# The fecundity function
Fecundity = function(a,L){
m1 = 1
m2 = 1
m3 = 1
m4 = 1
m5 = 1
m0 = m4*L^m5
m = m0*(1-exp(-m1*(a-m2))*exp(-m3*a))
return(m)
}
dscore = age
bscore = age
Number = matrix(0,total.time+1,1+Number.Strategies)
Number[1,]=c(0,t(unname(table(Popn$strategy))))
Number
dscore[Popn$age>=Popn$develop.time] = l1
dscore[Popn$age<Popn$develop.time] = l0
cum.dscore = cumsum(dscore)
r1 = runif(1, 0, length(Popn[,1]))
r1
ind.d = min(which(cum.dscore>r1))
ind.d
Popn = Popn[-ind.d,]
Popn
row.names(Popn) = seq(1,length(Popn[,1]))
Popn
bscore =rep(0,length(Popn[,1]))
bscore[Popn$age>=Popn$develop.time]=Fecundity(Popn$age[Popn$age>=Popn$develop.time],Popn$L[Popn$age>=Popn$develop.time])
bscore
Popn$age = Popn$age+1
cum.bscore = cumsum(bscore)
if(cum.bscore[length(Popn[,1])]>0){
# Select that strategy that reproduces
r1 = runif(1, 0, cum.bscore[length(Popn[,1])])
ind.b = min(which(cum.bscore>r1))
Popn = rbind(Popn,c(strategy = Popn$strategy[ind.b], age=0,L=Popn$L[ind.b]),develop.time=Popn$develop.time[ind.b])
row.names(Popn) = seq(1,length(Popn[,1]))
}
Popn$age = Popn$age+1
Popn$age = Popn$age+1
bscore =rep(0,length(Popn[,1]))
bscore[Popn$age>=Popn$develop.time]=Fecundity(Popn$age[Popn$age>=Popn$develop.time],Popn$L[Popn$age>=Popn$develop.time])
cum.bscore = cumsum(bscore)
cum.bscore
r1 = runif(1, 0, cum.bscore[length(Popn[,1])])
r1
cum.bscore[length(Popn[,1])]
if(cum.bscore[length(Popn[,1])]>0){
r1 = runif(1, 0, cum.bscore[length(Popn[,1])])
ind.b = min(which(cum.bscore>r1))
ind.b
Popn = rbind(Popn,c(strategy = Popn$strategy[ind.b], age=0,L=Popn$L[ind.b]),develop.time=Popn$develop.time[ind.b])
row.names(Popn) = seq(1,length(Popn[,1]))
if(cum.bscore[length(Popn[,1])]>0){
# Select that strategy that reproduces
r1 = runif(1, 0, cum.bscore[length(Popn[,1])])
ind.b = min(which(cum.bscore>r1))
Popn = rbind(Popn,c(strategy = Popn$strategy[ind.b], age=0,L=Popn$L[ind.b]),develop.time=Popn$develop.time[ind.b])
row.names(Popn) = seq(1,length(Popn[,1]))
}
)
if(cum.bscore[length(Popn[,1])]>0){
# Select that strategy that reproduces
r1 = runif(1, 0, cum.bscore[length(Popn[,1])])
ind.b = min(which(cum.bscore>r1))
Popn = rbind(Popn,c(strategy = Popn$strategy[ind.b], age=0,L=Popn$L[ind.b]),develop.time=Popn$develop.time[ind.b])
row.names(Popn) = seq(1,length(Popn[,1]))
}
Popn
cum.bscore = cumsum(bscore)
cum.bscore
r1 = runif(1, 0, cum.bscore[length(Popn[,1])])
Popn
r1
r1 = runif(1, 0, cum.bscore[length(Popn[,1])])
bscore
cum.bscore = cumsum(bscore)
r1 = runif(1, 0, cum.bscore[length(Popn[,1])])
cum.bscore
Popn
Popn[,1]
cum.bscore[length(Popn[,1])]
cum.bscore
length(Popn[,1])
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
Popn
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
Popn
table(Popn$strategy)
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
count(Popn$strategy)
count(Popn$strategy, vars = seq(1, Number.Strategies))
seq(1, Number.Strategies)
Popn$strategy
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
strategies.summary = count(Popn$strategy, vars = "strategy.nums")
strategies.summary
strategies.count = rep(0,Number.Strategies)
strategies.summary = table(Popn$strategy)
strategies.summary
names(strategies.summary)
as.numeric(names(strategies.summary))
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
Popn
Number
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
Number[,2]
min(Number[,2:Number.Strategies+1])
Number[,2:Number.Strategies+1]
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
source('~/Desktop/BIOL-3295/Labs/Lab 6/Body_Size_Evolution.R')
